input,output
What are the differences between RAT 1 and RAT 2?,"RAT 1 is a Remote Access Trojan. RAT 2 is also a Remote Access Trojan, and it was planted by the attacker on Workstation B. The document refers to RAT 1 as ""RAT 2"" in this report."
Describe the evidence of the attacker's lateral movements.,"Evidence of the attacker's lateral movements was found in the proliferation of malware across a number of endpoints and servers. Malware samples analyzed by CSA were either stealthy by design or unique variants not seen in the wild and not detected by standard anti-malware solutions. Such malware included RAT 1, also referred to as RAT 2, and malware associated with a log file."
What types of malware were found and analyzed by CSA?,"Malware samples found and analyzed by CSA were either tools that were stealthy by design, or unique variants that were not seen in-the-wild and not detected by standard anti-malware solutions."
Explain how the attacker distributed malware.,The attacker used PowerShell commands to distribute malware to infect other machines. Malicious files were also copied between machines over mapped network drives.
What did CSA assess regarding the attacker's access to the Windows system?,CSA assessed that the attacker likely compromised the Windows authentication system and obtained administrator and user credentials.
What level of control did the attacker gain after compromising the Windows authentication system?,"After compromising the Windows authentication system, the attacker gained full control over all Windows-based servers and hosted applications, as well as all employee workstations and underlying data within the domain."
When did the attacker establish control over Workstation B?,The attacker established control over Workstation B on 17 April 2018.
What actions did the attacker take after gaining access to Workstation B?,"After gaining access to Workstation B (SGH), the attacker planted RAT 2, thus gaining control of the workstation. This workstation had access to the SCM application."
How was Workstation B utilized by the attacker?,Workstation B was used by the attacker to log in remotely to the SGH Citrix Servers 1 and 2.
When did the attacker begin querying the SCM database?,The attacker began querying the SCM database from Citrix Server 2 using the A.A. account from 26 June 2018.
What are the three types of SQL queries the attacker ran against the SCM database?,"The three types of SQL queries the attacker ran were: (i) reconnaissance on the schema of the SCM database, (ii) direct queries relating to particular individuals, and (iii) bulk queries on patients in general."
What information was retrieved by the attacker from the SQL queries?,"The attacker retrieved the following information: The Prime Minister's personal and outpatient medication data; the demographic records of 1,495,364 patients, including their names, NRIC numbers, addresses, gender, race, and dates of birth; and the outpatient dispensed medication records of about 159,000 of the 1,495,364 patients."
Describe the data exfiltration route.,"The data exfiltration route involved C2 servers, Workstation A, Citrix Server 2, and the SCM DB Server. Exfiltration occurred from Workstation A."
When was the copying and exfiltration of data from the SCM database stopped?,The copying and exfiltration of data from the SCM database was stopped on 4 July 2018.
How was the data exfiltration stopped?,The data exfiltration was stopped after staff from IHiS discovered unusual queries and took steps to prevent any similar queries from being run against the SCM database.
What recommendation did CSA make after detecting malware and communications from the S.P. server?,"After detecting malware and communications from the S.P. server, CSA recommended that internet surfing separation should be implemented to prevent the attacker from exercising command and control over any remaining footholds in the network."
When was internet surfing separation implemented?,Internet surfing separation was implemented on 20 July 2018.
What was the outcome after implementing internet surfing separation?,No further signs of malicious activity were detected thereafter.
Compare PowerShell commands and mapped network drives in the context of malware distribution.,"PowerShell commands were used by the attacker to distribute malware to infect other machines. Malicious files were also copied between machines over mapped network drives, serving as another method for malware distribution."
What is the significance of compromising the Windows authentication system?,"Compromising the Windows authentication system allowed the attacker to obtain administrator and user credentials, which in turn granted them full control over Windows-based servers, hosted applications, employee workstations, and underlying data within the domain."
Explain the role of Workstation B in the attack.,"Workstation B was compromised by the attacker on 17 April 2018. The attacker planted RAT 2 on this workstation, gaining control of it. Workstation B was then used to remotely access the SGH Citrix Servers 1 and 2, and it had access to the SCM application."
What is a Remote Access Trojan (RAT)?,A Remote Access Trojan (RAT) is a type of malware that allows an attacker to remotely control a compromised computer. RAT 1 and RAT 2 are examples of such Trojans mentioned in the context of the attack.
What are the implications of malware being stealthy by design or not detected by standard anti-malware solutions?,"Malware that is stealthy by design or not detected by standard anti-malware solutions poses a significant threat because it can evade detection by conventional security measures, allowing attackers to operate undetected within a network for longer periods."
Describe the types of data accessed by the attacker from the SCM database.,"The attacker accessed the Prime Minister's personal and outpatient medication data, demographic records of 1,495,364 patients (including names, NRIC numbers, addresses, gender, race, and dates of birth), and outpatient dispensed medication records of approximately 159,000 patients."
What is the SCM database in this context?,"The SCM database is a system that contains sensitive patient information, including demographic records and medication data. The attacker queried this database to retrieve personal and medical information."
What is the function of C2 servers in the context of the data exfiltration route?,"C2 servers, which stand for Command and Control servers, are typically used by attackers to communicate with compromised systems. In the data exfiltration route, they are part of the infrastructure that facilitates the attacker's operations, including the exfiltration of data."
What is the difference between reconnaissance queries and direct queries?,"Reconnaissance queries are used to explore the structure or schema of a database, helping the attacker understand what information is available. Direct queries, on the other hand, are used to retrieve specific pieces of information, such as data related to particular individuals."
What is the purpose of bulk queries on patients?,"Bulk queries on patients are used to retrieve large amounts of data pertaining to many individuals at once. In this case, the attacker used bulk queries to obtain general patient information."
What is the significance of the attacker using the A.A. account?,"The attacker used the A.A. account to query the SCM database from Citrix Server 2. The specific nature or privileges of this account are not detailed, but its use indicates a method of accessing the database."
What is the difference between Workstation A and Citrix Server 2 in the data exfiltration route?,"In the data exfiltration route, Workstation A is depicted as a point from which exfiltration occurs, connecting to C2 servers. Citrix Server 2 is shown as an intermediary, receiving queries from Workstation A and connecting to the SCM DB Server."
What is the role of the SCM DB Server?,The SCM DB Server is the database server that stores the SCM data. It is the source from which the attacker retrieved sensitive patient information through SQL queries.
What does 'proliferation of malware' mean in this context?,'Proliferation of malware' means that the malware spread widely across a number of endpoints and servers within the network. This indicates the attacker's success in distributing malicious software.
What is meant by 'in-the-wild' variants of malware?,"'In-the-wild' variants of malware refer to malware that has been observed and is actively circulating in the general computing environment, as opposed to being a custom-developed or contained sample."
What are 'mapped network drives'?,"'Mapped network drives' are network resources, such as shared folders on other computers or servers, that are assigned a drive letter on a user's computer, making them appear as if they are local drives. The attacker used these to copy malicious files between machines."
What are 'administrator and user credentials'?,'Administrator and user credentials' are the usernames and passwords used to authenticate and gain access to a computer system or network. Administrator credentials typically grant higher levels of access and control than user credentials.
What is the difference between a server and a workstation?,"A server is a computer or system that provides resources, data, services, or programs to other computers, known as clients, over a network. A workstation is a high-performance computer designed for technical or scientific applications, typically used by a single user."
What is the 'SCM application'?,"The 'SCM application' is an application that the attacker gained access to via Workstation B. The document does not specify its exact function, but it was accessible from the compromised workstation."
What is the significance of the attacker gaining remote access to SGH Citrix Servers 1 and 2?,"Gaining remote access to SGH Citrix Servers 1 and 2 via Workstation B allowed the attacker to potentially access resources and systems hosted on these servers, expanding their reach within the network."
What is a 'schema' in the context of a database?,"In the context of a database, a 'schema' refers to the blueprint or structure of the database. It defines the tables, columns, relationships, and other constraints that organize the data."
What is the difference between personal medication data and outpatient dispensed medication records?,"Personal medication data refers to information about a person's medications, which could include prescriptions, dosages, and usage. Outpatient dispensed medication records specifically detail the medications that were dispensed to patients who were not admitted to the hospital (outpatients)."
What is an NRIC number?,"An NRIC number is the National Registration Identity Card number, which is a unique identifier for Singaporean citizens and permanent residents."
What is the purpose of 'internet surfing separation'?,'Internet surfing separation' is a security measure implemented to prevent attackers from accessing the internet from compromised systems. This is done to stop them from exercising command and control over the network or communicating with external malicious infrastructure.
What does it mean to have 'footholds' in a network?,'Footholds' in a network refer to the points of access or control that an attacker has established within the network. These can be compromised systems or accounts that allow the attacker to maintain a presence and move laterally.
What is the difference between privilege escalation and lateral movement?,"Privilege escalation is the process by which an attacker gains higher-level permissions on a system than they initially had. Lateral movement is the process by which an attacker moves from one compromised system to another within a network, often to gain access to more valuable data or systems."
What is the time frame of the privilege escalation and lateral movement activities described?,The privilege escalation and lateral movement activities described occurred between December 2017 and June 2018.
What is the significance of the malware being 'not detected by standard anti-malware solutions'?,"Malware not detected by standard anti-malware solutions indicates that the attacker used sophisticated or custom-developed tools that bypassed common security software, making it harder to identify and remove the threat."
What is the role of CSA in this incident?,"CSA (Cyber Security Agency) analyzed malware samples, assessed the attacker's compromise of the Windows authentication system, and recommended security measures such as internet surfing separation."
What is the difference between Workstation B and Citrix Server 2 in terms of their role in the attack?,Workstation B was a compromised endpoint used by the attacker to gain access to the SCM application and to remotely log into Citrix Server 2. Citrix Server 2 was then used by the attacker to query the SCM database.

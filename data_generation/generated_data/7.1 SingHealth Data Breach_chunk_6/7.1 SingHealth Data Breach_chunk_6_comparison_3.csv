input,output
What are the differences between RAT 1 and RAT 2?,"RAT 1 is a Remote Access Trojan. RAT 2 is also a Remote Access Trojan, and it was planted by the attacker on Workstation B. The document refers to RAT 1 as ""RAT 2"" in this report."
Explain the role of PowerShell commands in the attack.,"PowerShell commands were used by the attacker to distribute malware to infect other machines. Additionally, malicious files were copied between machines over mapped network drives using these commands."
What was the significance of compromising the Windows authentication system?,"Compromising the Windows authentication system allowed the attacker to obtain administrator and user credentials. This, in turn, granted the attacker full control over all Windows-based servers and hosted applications, as well as all employee workstations and their underlying data within the domain."
Describe how the attacker gained control of Workstation B.,"The attacker gained access to Workstation B (SGH) and planted RAT 2 on it. This action resulted in the attacker gaining control of the workstation, which had access to the SCM application."
How was Workstation B utilized by the attacker after gaining control?,"After gaining control of Workstation B, the attacker used it to log in remotely to the SGH Citrix Servers 1 and 2."
When did the attacker begin querying the SCM database and from which server?,"The attacker began querying the SCM database from Citrix Server 2 on 26 June 2018, using the A.A. account."
What were the three types of SQL queries executed by the attacker?,"The attacker ran three types of SQL queries: (i) reconnaissance on the schema of the SCM database, (ii) direct queries relating to particular individuals, and (iii) bulk queries on patients in general."
What specific information was retrieved by the attacker from the SCM database via SQL queries?,"The attacker retrieved the Prime Minister's personal and outpatient medication data. Additionally, demographic records of 1,495,364 patients, including their names, NRIC numbers, addresses, gender, race, and dates of birth, were accessed. The attacker also retrieved outpatient dispensed medication records for approximately 159,000 of these patients."
What is depicted in Figure 11?,"Figure 11 illustrates the data exfiltration route. It shows the flow from C2 servers to Workstation A, then to Citrix Server 2, and finally to the SCM DB Server, with exfiltration occurring from Workstation A."
"When was the copying and exfiltration of data from the SCM database stopped, and how?",The copying and exfiltration of data from the SCM database was stopped on 4 July 2018. This occurred after staff from IHiS discovered unusual queries and implemented measures to prevent similar queries from being run against the SCM database.
What recommendation was made by CSA after detecting malware and communications from the S.P. server?,"After detecting malware and communications from the S.P. server, CSA recommended that internet surfing separation should be implemented. This measure was intended to prevent the attacker from exercising command and control over any remaining footholds in the network."
"When was internet surfing separation implemented, and what was the outcome?","Internet surfing separation was implemented on 20 July 2018. Following this implementation, no further signs of malicious activity were detected."
Compare stealthy malware with unique variants of malware.,"Stealthy malware is designed to be covert in its operation. Unique variants of malware are those that have not been previously observed in the wild. Both types of malware, when found and analyzed by CSA, were not detected by standard anti-malware solutions."
What is a Remote Access Trojan (RAT)?,A Remote Access Trojan (RAT) is a type of malware that allows an attacker to remotely control a compromised computer. RAT 1 and RAT 2 are examples of such Trojans mentioned in the context of the attack.
What is the significance of 'in-the-wild' in the context of malware analysis?,"'In-the-wild' refers to malware that is actively circulating and being used in real-world attacks. Malware samples that were not seen 'in-the-wild' suggest they were either novel or specifically developed for this attack, making them harder for standard defenses to detect."
What is the function of standard anti-malware solutions?,"Standard anti-malware solutions are designed to detect and prevent known malicious software. In this incident, some of the malware samples used by the attacker were unique variants not seen in the wild, and therefore were not detected by these standard solutions."
What is a log file in the context of cybersecurity incidents?,"A log file is a record of events that occur on a computer system or network. In this incident, malware associated with an earlier-mentioned log file was part of the attacker's toolkit, indicating that the log file contained relevant information about the attack."
What are mapped network drives?,"Mapped network drives are network resources (like shared folders on other computers) that are assigned a drive letter on a local computer, making them appear as if they are local drives. The attacker used these to copy malicious files between machines."
What is the Windows authentication system?,The Windows authentication system is responsible for verifying the identity of users and devices attempting to access resources on a Windows network. Compromising this system allows an attacker to gain unauthorized access and control.
What are administrator and user credentials?,"Administrator credentials are the username and password for an account with the highest level of privileges on a system, allowing full control. User credentials are for standard accounts with more limited permissions. Obtaining both allowed the attacker broad access."
What is meant by 'full control' in the context of a compromised network?,"'Full control' implies the ability to manage, modify, access, and delete any data or system configurations without restriction. In this case, the attacker had full control over servers, applications, workstations, and data within the domain."
What are hosted applications?,"Hosted applications are software programs that are run on servers and accessed by users remotely, often over a network. The attacker gained full control over these applications hosted on Windows-based servers."
What are employee workstations?,"Employee workstations are the computers used by individuals within an organization for their daily tasks. The attacker gained full control over these, including the data stored on them."
What is a 'domain' in a network context?,"A domain is a network administration boundary that defines a group of computers and users managed by a central authority, typically using Windows Server. The attacker's control extended to all resources within this domain."
What is the SCM application?,The SCM application is a software application that the attacker gained access to via Workstation B. The document does not provide further details on its specific function.
What are Citrix Servers?,"Citrix Servers are servers that provide access to applications and desktops remotely. Workstation B was used to log in remotely to SGH Citrix Servers 1 and 2, indicating these were likely used to access further resources."
What is the SCM database?,The SCM database is a data repository that the attacker queried between 26 June and 4 July 2018. It contained sensitive patient information.
What is the A.A. account?,The A.A. account was the user account used by the attacker to query the SCM database from Citrix Server 2. The document does not specify the nature or privileges of this account.
What is the schema of a database?,"The schema of a database refers to its structure, including the organization of tables, columns, relationships, and other objects. Reconnaissance queries on the schema helped the attacker understand the database's layout."
What is meant by 'direct queries relating to particular individuals'?,"This refers to SQL queries specifically designed to retrieve information about individual patients within the SCM database, rather than general data or structural information."
What are 'bulk queries on patients in general'?,"These are SQL queries designed to retrieve large amounts of data pertaining to many patients simultaneously, as opposed to specific individuals. This was one of the types of queries the attacker used."
What is NRIC?,"NRIC stands for National Registration Identity Card, a unique identification number for Singaporean citizens and permanent residents. This number was part of the demographic records retrieved by the attacker."
What is data exfiltration?,Data exfiltration is the unauthorized transfer of data from a computer system or network to an external location. Figure 11 illustrates the route used for exfiltrating data from the SCM database.
What are C2 servers?,"C2 servers, short for Command and Control servers, are used by attackers to communicate with and control compromised systems. In the data exfiltration route diagram, C2 servers are shown as the origin point for the attacker's operations."
What is the purpose of internet surfing separation?,Internet surfing separation is a security measure implemented to prevent users from accessing the internet directly from their workstations. Its purpose is to limit the attacker's ability to exercise command and control over any remaining footholds in the network.
What is a 'foothold' in a network security context?,A 'foothold' refers to a point of entry or a persistent presence that an attacker has established within a network. Internet surfing separation was recommended to prevent the attacker from maintaining or expanding these footholds.
What is the difference between privilege escalation and lateral movement?,Privilege escalation is the process by which an attacker gains higher-level permissions on a system than they initially had. Lateral movement is the process by which an attacker moves from one compromised system to another within a network to expand their access and reach.
What was the timeframe of the privilege escalation and lateral movement activities described?,The privilege escalation and lateral movement activities described in the document occurred between December 2017 and June 2018.
What evidence was found regarding the attacker's lateral movements?,Evidence of the attacker's lateral movements was found in the proliferation of malware across a number of endpoints and servers.
What was the nature of the malware samples analyzed by CSA?,"The malware samples analyzed by CSA were either tools that were stealthy by design or unique variants that were not seen in the wild. Crucially, these samples were not detected by standard anti-malware solutions."
What is the relationship between RAT 1 and RAT 2 as described in the document?,"The document states that such malware included RAT 1, and then refers to another Remote Access Trojan as ""RAT 2"". It implies that RAT 1 is also referred to as RAT 2 in the report."
How did the attacker distribute malware to infect other machines?,The attacker used PowerShell commands to distribute malware to infect other machines. Malicious files were also copied between machines over mapped network drives.
What was the attacker's objective in compromising the Windows authentication system?,"The attacker's objective in compromising the Windows authentication system was to obtain administrator and user credentials, which would grant them full control over the network."
What specific systems and data did the attacker gain full control over?,"Upon gaining full control, the attacker had command over all Windows-based servers and hosted applications, all employee workstations, and the underlying data within the domain."
On what date did the attacker establish control over Workstation B?,The attacker established control over Workstation B on 17 April 2018.
What was the immediate consequence of the attacker gaining control of Workstation B?,"Gaining control of Workstation B allowed the attacker to access the SCM application, as Workstation B had prior access to it."
What was the timeframe for the queries to the SCM database?,The queries to the SCM database occurred from 26 June to 4 July 2018.
What types of patient data were accessed through the SQL queries?,"The SQL queries allowed the attacker to access the Prime Minister's personal and outpatient medication data, demographic records of 1,495,364 patients (including names, NRIC numbers, addresses, gender, race, and dates of birth), and outpatient dispensed medication records of about 159,000 patients."
What steps were taken to prevent further similar queries against the SCM database?,"After discovering the unusual queries, staff from IHiS took steps to prevent any similar queries from being run against the SCM database."
What was the date of implementation for internet surfing separation?,Internet surfing separation was implemented on 20 July 2018.

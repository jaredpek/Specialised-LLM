input,output
Provide a comprehensive summary of the privilege escalation and lateral movement activities that occurred between December 2017 and June 2018.,"Between December 2017 and June 2018, evidence of an attacker's lateral movements was observed through the proliferation of malware across numerous endpoints and servers. The malware samples analyzed were either designed to be stealthy or were unique variants not previously seen and undetectable by standard anti-malware solutions. This malware included RAT 1, also referred to as RAT 2 (a Remote Access Trojan), and other malware associated with a specific log file. The attacker utilized PowerShell commands to distribute this malware and infect other machines, copying malicious files between systems via mapped network drives. The Cybersecurity and Science Agency (CSA) assessed that the attacker likely compromised the Windows authentication system, obtaining administrator and user credentials. This compromise granted the attacker full control over all Windows-based servers, hosted applications, employee workstations, and underlying data within the domain. Specifically, on April 17, 2018, the attacker gained access to Workstation B, planted RAT 2, and thus controlled the workstation, which had access to the SCM application. Workstation B was subsequently used for remote logins to SGH Citrix Servers 1 and 2."
Summarize the types of SQL queries used by the attacker against the SCM database and the data retrieved.,"Between June 26 and July 4, 2018, the attacker queried the SCM database from Citrix Server 2 using the A.A. account. Three types of SQL queries were executed: reconnaissance queries on the SCM database schema, direct queries for specific individuals, and bulk queries concerning patients in general. From these queries, the attacker retrieved the Prime Minister's personal and outpatient medication data, demographic records of 1,495,364 patients (including names, NRIC numbers, addresses, gender, race, and dates of birth), and outpatient dispensed medication records for approximately 159,000 of these patients."
Describe the data exfiltration route used by the attacker.,"The data exfiltration route involved the SCM DB Server, Citrix Server 2, and Workstation A. Data was exfiltrated from the SCM DB Server, likely processed or accessed via Citrix Server 2, and then transferred from Workstation A to C2 servers. This process was visualized in Figure 11, illustrating the flow of data from the SCM database through the network infrastructure to external command and control servers."
Explain how the data exfiltration was stopped and what measures were taken.,"The copying and exfiltration of data from the SCM database were halted on July 4, 2018. This occurred after staff from IHiS (Integrated Health Information Systems) detected unusual queries and implemented measures to prevent similar queries from being executed against the SCM database in the future."
"What recommendations were made after the detection of malware and communications from the S.P. server, and when was the implemented measure put into effect?","Following the detection of malware and communications from the S.P. server, the CSA recommended the implementation of internet surfing separation. This measure was intended to prevent the attacker from exercising command and control over any remaining footholds within the network. Internet surfing separation was implemented on July 20, 2018."
What was the outcome of implementing internet surfing separation?,"After the implementation of internet surfing separation on July 20, 2018, no further signs of malicious activity were detected."
Summarize the initial evidence of the attacker's lateral movements.,Evidence of the attacker's lateral movements was found in the proliferation of malware across a number of endpoints and servers. The malware samples analyzed were either stealthy by design or unique variants not previously seen in the wild and undetectable by standard anti-malware solutions.
What types of malware were identified as part of the attacker's toolkit?,"The malware identified included RAT 1, which is a Remote Access Trojan. This was also referred to in the report as ""RAT 2."" Additionally, other malware associated with an earlier-mentioned log file was part of the attacker's toolkit."
How did the attacker distribute malware and move between machines?,The attacker used PowerShell commands to distribute malware and infect other machines. Malicious files were copied between machines over mapped network drives.
What was CSA's assessment regarding the attacker's access to the Windows authentication system?,CSA assessed that the attacker was likely to have compromised the Windows authentication system and obtained administrator and user credentials.
What level of control did the attacker gain after compromising the Windows authentication system?,"After compromising the Windows authentication system, the attacker gained full control over all Windows-based servers and hosted applications, as well as all employee workstations and the underlying data within the domain."
Detail the events of establishing control over Workstation B.,"On April 17, 2018, the attacker gained access to Workstation B (SGH) and planted RAT 2. This action resulted in the attacker gaining control of the workstation, which had access to the SCM application. Subsequently, Workstation B was used to log in remotely to the SGH Citrix Servers 1 and 2."
When did the attacker begin querying the SCM database and from which server?,"The attacker began querying the SCM database from Citrix Server 2 on June 26, 2018, using the A.A. account."
What was the purpose of the reconnaissance queries on the SCM database?,"The reconnaissance queries on the SCM database were used to understand its schema, which is the structure or organization of the database."
What kind of personal information was retrieved through the SQL queries?,"Through the SQL queries, the attacker retrieved the Prime Minister's personal and outpatient medication data. Additionally, demographic records of 1,495,364 patients were accessed, including their names, NRIC numbers, addresses, gender, race, and dates of birth. Medication records for approximately 159,000 of these patients were also retrieved."
Define 'demographic records' in the context of the retrieved patient information.,"In the context of the retrieved patient information, 'demographic records' refer to data that describes the characteristics of a population. This includes details such as names, NRIC numbers, addresses, gender, race, and dates of birth."
Define 'Remote Access Trojan' (RAT).,A Remote Access Trojan (RAT) is a type of malware that allows an attacker to remotely control a compromised computer. It operates by appearing as legitimate software but secretly provides the attacker with access and control over the victim's system.
What is meant by 'proliferation of malware'?,'Proliferation of malware' refers to the rapid spread and increase in the number of malware instances or infections across multiple systems and networks.
Explain the term 'endpoints' in the context of network security.,"In the context of network security, 'endpoints' refer to the devices that connect to a network and are used by individuals. This typically includes computers, laptops, servers, mobile devices, and other connected hardware."
What does it mean for malware to be 'stealthy by design'?,"Malware that is 'stealthy by design' is intentionally created with features and techniques to evade detection by security software and systems. This can include methods to hide its presence, avoid signature-based detection, and operate without raising suspicion."
What are 'unique variants' of malware?,"'Unique variants' of malware are modified or new versions of existing malware that have been altered to bypass existing security measures. These variations often differ in their code, behavior, or signature, making them harder to detect by traditional security tools."
What is 'in-the-wild' in relation to malware?,"'In-the-wild' refers to malware that is actively being used in real-world attacks and is present in the environment, as opposed to being in a laboratory or testing phase."
Define 'standard anti-malware solutions'.,"'Standard anti-malware solutions' refer to common and widely used security software designed to detect, prevent, and remove malicious software (malware) from computer systems. These solutions typically rely on signature databases, heuristic analysis, and behavioral monitoring."
What is a 'log file' in the context of cybersecurity?,"In cybersecurity, a 'log file' is a record of events that occur on a computer system or network. These files can contain valuable information about system activities, user actions, errors, and security-related incidents, which can be used for analysis and investigation."
Explain 'PowerShell commands' in the context of the attacker's actions.,"'PowerShell commands' are instructions executed using PowerShell, a task automation and configuration management framework from Microsoft. Attackers use PowerShell commands to perform various actions on compromised systems, such as distributing malware, executing scripts, and gathering information."
What are 'mapped network drives'?,"'Mapped network drives' are network resources (like shared folders on other computers or servers) that are assigned a drive letter on a local computer, making them appear as if they are local drives. This allows for easier access and file transfer between networked systems."
What is the 'Windows authentication system'?,"The 'Windows authentication system' is the mechanism used by Microsoft Windows operating systems to verify the identity of users and devices attempting to access network resources. It involves processes like username and password checks, and the management of credentials."
Define 'administrator credentials'.,"'Administrator credentials' are the username and password combination that grants a user elevated privileges on a computer system or network. These credentials allow for full control over system settings, software installation, and access to all files and resources."
Define 'user credentials'.,"'User credentials' are the username and password combination used by a standard user to log in to a computer system or access network resources. These credentials typically grant access to a defined set of resources and functionalities, usually with fewer privileges than administrator credentials."
What does it mean to have 'full control' over servers and workstations?,"Having 'full control' over servers and workstations means having the ability to perform any action on these systems, including installing or removing software, modifying system settings, accessing all data, and controlling user access. This level of control is typically held by system administrators."
What are 'hosted applications'?,"'Hosted applications' are software programs that are run on servers and made accessible to users over a network, rather than being installed directly on each user's device. This allows for centralized management and access."
"What is meant by 'underlying data, within the domain'?","'Underlying data, within the domain' refers to all the information stored on the servers and workstations that are part of the organization's network (the domain). This includes files, databases, user data, and any other digital assets."
What is the SCM application?,"The SCM application is a software application that the attacker gained access to via Workstation B. Its specific function is not detailed, but it was a target of the attacker's access."
What are SGH Citrix Servers?,"SGH Citrix Servers are servers managed by Singapore General Hospital (SGH) that utilize Citrix technology. Citrix is a company that provides virtualization, networking, and cloud computing technologies, often used to deliver applications and desktops remotely."
What is a 'database'?,"A database is an organized collection of structured information, or data, typically stored electronically in a computer system. Databases are designed to store, retrieve, and manage data efficiently."
Define 'SCM database'.,"The 'SCM database' is a specific database that the attacker queried. Its full name or purpose is not explicitly stated, but it contained patient information and medication data."
What is an 'A.A. account'?,An 'A.A. account' is a user account that the attacker used to access the SCM database from Citrix Server 2. The specific nature or privileges of this account are not detailed.
What are 'SQL queries'?,"'SQL queries' are commands written in Structured Query Language (SQL), a standard language used to manage and manipulate relational databases. They are used to retrieve, insert, update, and delete data from a database."
Explain 'reconnaissance' in the context of cybersecurity.,"In cybersecurity, 'reconnaissance' is the initial phase of an attack where an attacker gathers information about a target system or network. This can involve scanning for open ports, identifying software versions, and understanding the network structure to plan subsequent actions."
What is the 'schema' of a database?,"The 'schema' of a database refers to its logical structure or blueprint. It defines how the data is organized, including the tables, the columns within those tables, the relationships between tables, and the data types of each column."
What is meant by 'direct queries relating to particular individuals'?,"'Direct queries relating to particular individuals' means the attacker specifically searched the database for information pertaining to specific people, rather than general information or structural details."
What are 'bulk queries on patients in general'?,"'Bulk queries on patients in general' refers to the attacker running queries that retrieve large amounts of data about many patients simultaneously, without necessarily targeting specific individuals. This suggests an intent to gather broad datasets."
What is 'outpatient medication data'?,'Outpatient medication data' refers to information about medications prescribed to and dispensed for patients who receive medical care without being admitted to a hospital overnight.
Define 'NRIC number'.,"An 'NRIC number' is the National Registration Identity Card number, which is a unique identification number issued to citizens and permanent residents in Singapore."
What is 'data exfiltration'?,"'Data exfiltration' is the unauthorized transfer of data from a computer system or network to an external location. It is a common objective in cyberattacks, where attackers steal sensitive information."
What are 'C2 servers'?,'C2 servers' (Command and Control servers) are servers used by attackers to communicate with and control compromised systems (bots or malware) in a botnet or during an attack. They act as a central point for issuing commands and receiving data.
Who are 'IHiS staff'?,"'IHiS staff' refers to employees of Integrated Health Information Systems, an organization responsible for managing health information technology in Singapore's public healthcare sector. They were the ones who discovered the unusual queries."
What is 'internet surfing separation'?,"'Internet surfing separation' is a security measure implemented to restrict or control the ability of users or systems to access the internet. In this context, it was used to prevent attackers from communicating with compromised systems over the internet."
What are 'footholds' in a network?,'Footholds' in a network refer to the points of access or control that an attacker has established within a compromised system or network. These footholds allow the attacker to maintain persistence and conduct further malicious activities.

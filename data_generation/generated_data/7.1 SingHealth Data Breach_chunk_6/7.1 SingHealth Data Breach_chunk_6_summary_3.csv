input,output
Provide a comprehensive summary of the privilege escalation and lateral movement activities that occurred between December 2017 and June 2018.,"Between December 2017 and June 2018, evidence of an attacker's lateral movements was observed through the proliferation of malware across numerous endpoints and servers. The malware samples analyzed were either designed to be stealthy or were unique variants not previously seen and undetected by standard anti-malware solutions. This malware included RAT 1, also referred to as RAT 2 (a Remote Access Trojan), and other malware linked to a specific log file. The attacker utilized PowerShell commands to distribute this malware and infect other machines, and malicious files were copied between machines via mapped network drives. The Computer Security Incident Response Team (CSIRT) assessed that the attacker likely compromised the Windows authentication system, obtaining administrator and user credentials. This compromise granted the attacker full control over all Windows-based servers, hosted applications, employee workstations, and underlying data within the domain. Specifically, on April 17, 2018, the attacker gained access to Workstation B, planted RAT 2, and consequently controlled the workstation, which had access to the SCM application. Workstation B was then used for remote logins to SGH Citrix Servers 1 and 2."
Summarize the types of SQL queries used by the attacker and the data retrieved from the SCM database.,"From June 26 to July 4, 2018, the attacker queried the SCM database from Citrix Server 2 using the A.A. account. Three types of SQL queries were employed: reconnaissance queries on the SCM database schema, direct queries for specific individuals, and bulk queries concerning patients in general. Through these SQL queries, the attacker retrieved the Prime Minister's personal and outpatient medication data, demographic records of 1,495,364 patients (including names, NRIC numbers, addresses, gender, race, and dates of birth), and outpatient dispensed medication records for approximately 159,000 of these patients. The copying and exfiltration of data from the SCM database were halted on July 4, 2018, when IHiS staff detected unusual queries and implemented measures to prevent similar activities."
Describe the data exfiltration route used by the attacker.,"The data exfiltration route involved the attacker's access to the SCM database. The process began with the attacker querying the SCM database, likely from Citrix Server 2, using the A.A. account. The retrieved data, including sensitive patient information and medication records, was then exfiltrated. The diagram illustrates that Workstation A was involved in this process, with an exfiltration path leading from Workstation A to C2 servers. This suggests that data was likely transferred from the SCM DB Server to Citrix Server 2, then potentially to Workstation A, and finally exfiltrated to external C2 servers."
Explain the steps taken to stop the data exfiltration and prevent future similar incidents.,"The copying and exfiltration of data from the SCM database were stopped on July 4, 2018. This action was initiated after staff from IHiS discovered unusual queries being run against the SCM database. Following this discovery, steps were taken to prevent any similar queries from being executed against the database in the future. Additionally, after malware and communications from the S.P. server were detected, CSIRT recommended implementing internet surfing separation. This measure was implemented on July 20, 2018, to prevent the attacker from exercising command and control over any remaining footholds within the network. No further signs of malicious activity were detected after these measures were put in place."
What was the timeframe for the privilege escalation and lateral movement activities?,The privilege escalation and lateral movement activities occurred between December 2017 and June 2018.
What evidence was found regarding the attacker's lateral movements?,Evidence of the attacker's lateral movements was found in the proliferation of malware across a number of endpoints and servers.
Describe the characteristics of the malware samples found and analyzed.,"The malware samples found and analyzed were either tools that were stealthy by design, or unique variants that were not seen in-the-wild and not detected by standard anti-malware solutions."
What specific malware was identified as being used by the attacker?,"The malware identified included RAT 1, another Remote Access Trojan referred to in this report as “RAT 2”, and the malware associated with the earlier-mentioned log file."
How did the attacker distribute malware and move between machines?,The attacker used PowerShell commands to distribute malware to infect other machines. Malicious files were also copied between machines over mapped network drives.
What assessment was made regarding the attacker's compromise of the Windows authentication system?,CSIRT assessed that the attacker was likely to have compromised the Windows authentication system and obtained administrator and user credentials.
What level of control did the attacker gain after compromising the Windows authentication system?,"After compromising the Windows authentication system, the attacker gained full control over all Windows-based servers and hosted applications, all employee workstations, and underlying data within the domain."
When did the attacker establish control over Workstation B?,"The attacker established control over Workstation B on April 17, 2018."
What actions did the attacker take on Workstation B?,"The attacker gained access to Workstation B (SGH) and planted RAT 2, thereby gaining control of the workstation. This workstation had access to the SCM application."
How was Workstation B utilized by the attacker?,Workstation B was used to log in remotely to the SGH Citrix Servers 1 and 2.
What was the timeframe for queries to the SCM database?,"Queries to the SCM database occurred from June 26 to July 4, 2018."
"From which server did the attacker begin querying the SCM database, and what account was used?","From June 26, 2018, the attacker began querying the SCM database from Citrix Server 2 using the A.A. account."
List the three types of SQL queries the attacker ran against the SCM database.,"The three types of SQL queries the attacker ran were: (i) reconnaissance on the schema of the SCM database, (ii) direct queries relating to particular individuals, and (iii) bulk queries on patients in general."
What personal data of the Prime Minister was retrieved?,The attacker retrieved the Prime Minister's personal and outpatient medication data.
"How many patients' demographic records were retrieved, and what information did they include?","The demographic records of 1,495,364 patients were retrieved. This information included their names, NRIC numbers, addresses, gender, race, and dates of birth."
How many patients' medication records were retrieved?,"The outpatient dispensed medication records of about 159,000 of the 1,495,364 patients were retrieved."
What does Figure 11 illustrate?,Figure 11 illustrates the data exfiltration route.
What components are shown in the data exfiltration route diagram?,"The data exfiltration route diagram shows C2 servers, Workstation A, Citrix Server 2, and the SCM DB Server. It also indicates an 'Exfiltration' path from Workstation A to C2 servers."
When was the copying and exfiltration of data from the SCM database stopped?,"The copying and exfiltration of data from the SCM database was stopped on July 4, 2018."
Who discovered the unusual queries and took steps to prevent similar activities?,Staff from IHiS discovered the unusual queries and took steps to prevent any similar queries from being run against the SCM database.
What was recommended after the detection of malware and communications from the S.P. server?,"After the detection of malware on and communications from the S.P. server, CSIRT recommended that internet surfing separation should be implemented."
What was the purpose of implementing internet surfing separation?,The purpose of implementing internet surfing separation was to prevent the attacker from exercising command and control over any remaining footholds it may have had in the network.
When was internet surfing separation implemented?,"Internet surfing separation was implemented on July 20, 2018."
Were there any further signs of malicious activity detected after the implementation of internet surfing separation?,No further signs of malicious activity were detected thereafter.
"Summarize the initial phase of the attack, including malware proliferation and lateral movement.","The initial phase of the attack, from December 2017 to June 2018, was characterized by the proliferation of malware across numerous endpoints and servers, indicating the attacker's lateral movements. The malware used was either stealthy by design or unique variants that evaded detection by standard anti-malware solutions. This malware included RAT 1 (RAT 2) and other associated malware. The attacker utilized PowerShell commands for malware distribution and copied malicious files between machines via mapped network drives."
Explain the attacker's method of gaining administrative privileges.,"The attacker likely gained administrative privileges by compromising the Windows authentication system. CSIRT assessed that the attacker obtained administrator and user credentials, which would grant them elevated access within the network."
Detail the scope of the attacker's control after compromising the network.,"Following the compromise of the Windows authentication system, the attacker achieved full control over the entire domain. This included all Windows-based servers, hosted applications, employee workstations, and all underlying data."
Describe the specific incident involving Workstation B and its implications.,"On April 17, 2018, the attacker gained access to Workstation B (SGH) and deployed RAT 2, thereby securing control of the workstation. Crucially, Workstation B had access to the SCM application. The attacker then leveraged Workstation B to remotely access the SGH Citrix Servers 1 and 2, extending their reach within the network."
What was the attacker's objective when querying the SCM database?,"The attacker's objective when querying the SCM database was to retrieve sensitive information. This included reconnaissance on the database structure, specific details about individuals, and general patient data."
What sensitive patient data was exfiltrated by the attacker?,"The attacker exfiltrated the Prime Minister's personal and outpatient medication data, demographic records of 1,495,364 patients (including names, NRIC numbers, addresses, gender, race, and dates of birth), and outpatient dispensed medication records of approximately 159,000 patients."
How was the data exfiltration process visually represented?,"The data exfiltration process was visually represented in Figure 11, which depicted a data exfiltration route. This route involved C2 servers, Workstation A, Citrix Server 2, and the SCM DB Server, with a clear indication of data being exfiltrated from Workstation A to the C2 servers."
What actions led to the cessation of data exfiltration?,"The cessation of data exfiltration occurred when staff from IHiS discovered unusual queries being run against the SCM database. Upon this discovery, they took immediate steps to stop the ongoing exfiltration and prevent future similar incidents."
What security measure was recommended to prevent further attacker activity?,"Following the detection of malware and communications from the S.P. server, CSIRT recommended the implementation of internet surfing separation. This measure was designed to cut off the attacker's ability to maintain command and control over any remaining access points within the network."
When was the network secured against further malicious activity?,"The network was secured against further malicious activity after the implementation of internet surfing separation on July 20, 2018. No further signs of malicious activity were detected after this date."
"Summarize the timeline of the cyber breach, from initial compromise to resolution.","The cyber breach spanned from December 2017 to July 2018. Initial activities involved privilege escalation and lateral movement from December 2017 to June 2018, including malware proliferation and credential compromise. On April 17, 2018, control of Workstation B was established, leading to remote access to Citrix servers. From June 26 to July 4, 2018, the attacker queried the SCM database and exfiltrated sensitive patient data. The exfiltration was stopped on July 4, 2018, by IHiS staff. Following detection of further malware activity, internet surfing separation was implemented on July 20, 2018, effectively ending further malicious activity."
What are the key components involved in the attacker's lateral movement and data access?,"The key components involved in the attacker's lateral movement and data access include endpoints and servers where malware proliferated, the Windows authentication system for credential compromise, Workstation B for gaining access to the SCM application and Citrix servers, Citrix Server 2 for querying the SCM database, and the SCM DB Server itself as the source of the data."
Define 'Remote Access Trojan' (RAT) in the context of the document.,"A Remote Access Trojan (RAT) is a type of malware that, when installed on a victim's computer, allows an attacker to remotely control that computer. In this context, RAT 1 and RAT 2 are identified as specific instances of such malware used by the attacker."
Define 'SQL queries' as used by the attacker.,"SQL queries are commands written in Structured Query Language (SQL) used to interact with databases. In this case, the attacker used SQL queries to retrieve specific information from the SCM database. The types of queries included reconnaissance on the database structure, targeted queries for individual data, and broader queries for general patient information."
Define 'data exfiltration' as described in the document.,"Data exfiltration refers to the unauthorized transfer of data from a computer system or network to an external location. In this document, it describes the process by which the attacker copied and removed sensitive patient data from the SCM database to external C2 servers."
Define 'command and control' in the context of cybersecurity.,"Command and control (C2) refers to the infrastructure and methods used by attackers to communicate with and manage compromised systems. Implementing internet surfing separation aimed to prevent the attacker from exercising command and control over any remaining footholds in the network, thereby disrupting their ability to issue commands and receive information from compromised machines."
Define 'endpoints' and 'servers' as they relate to the attack.,"Endpoints are devices that connect to a network, such as computers, laptops, and mobile devices. Servers are powerful computers that provide services or resources to other devices on the network. The attacker's lateral movements were evidenced by the proliferation of malware across a number of these endpoints and servers."
Define 'mapped network drives'.,"Mapped network drives are network shares that are assigned a drive letter on a user's computer, making them appear as if they are local drives. The attacker used mapped network drives to copy malicious files between machines, facilitating the spread of malware."
Define 'administrator and user credentials'.,"Administrator and user credentials are the usernames and passwords used to authenticate and gain access to computer systems and networks. The attacker compromised these credentials, likely through the Windows authentication system, which allowed them to gain elevated privileges and control over network resources."
Define 'domain' in the context of a computer network.,"In the context of a computer network, a domain is a network that shares a common directory database and security policies. The attacker gained full control over the entire domain, meaning all resources and devices within that network were under their command."
Define 'SCM application'.,"The SCM application is a software application that the attacker gained access to via Workstation B. While its specific function is not detailed, its access by the attacker was a critical step in their operation, leading to further network access."
Define 'Citrix Servers'.,"Citrix Servers are servers that provide virtualized applications and desktops, allowing users to access them remotely. The attacker used Workstation B to log in remotely to the SGH Citrix Servers 1 and 2, indicating they were using these servers as a pivot point for further network access or operations."
